{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://mosberg.github.io/schemas/brewing/beverages-schema.json",
  "title": "Brewing Beverage Definition",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "type",
    "schema_version",
    "id",
    "category",
    "style",
    "container",
    "rarity",
    "stack_size",
    "brewing",
    "stats",
    "quality",
    "aging",
    "spoilage",
    "carbonation",
    "visuals",
    "effects",
    "ingredients",
    "tags",
    "loot",
    "gates",
    "client"
  ],
  "properties": {
    "type": {
      "const": "brewing:beverage"
    },
    "schema_version": {
      "type": "integer",
      "minimum": 1
    },
    "id": {
      "$ref": "common-schema.json#/$defs/Identifier"
    },
    "category": {
      "type": "string",
      "minLength": 1
    },
    "style": {
      "type": "string",
      "minLength": 1
    },
    "container": {
      "$ref": "common-schema.json#/$defs/Identifier"
    },
    "rarity": {
      "$ref": "common-schema.json#/$defs/Rarity"
    },
    "stack_size": {
      "type": "integer",
      "minimum": 1,
      "maximum": 64
    },
    "meta": {
      "$ref": "#/$defs/Meta"
    },
    "brew_time_seconds": {
      "type": "number",
      "minimum": 0
    },
    "brew_time_ticks": {
      "type": "integer",
      "minimum": 0
    },
    "brewing": {
      "$ref": "#/$defs/Brewing"
    },
    "stats": {
      "$ref": "#/$defs/Stats"
    },
    "quality": {
      "$ref": "#/$defs/Quality"
    },
    "aging": {
      "$ref": "#/$defs/Aging"
    },
    "spoilage": {
      "$ref": "#/$defs/Spoilage"
    },
    "carbonation": {
      "$ref": "#/$defs/Carbonation"
    },
    "visuals": {
      "$ref": "#/$defs/Visuals"
    },
    "effects": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/StatusEffect"
      },
      "default": []
    },
    "ingredients": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/IngredientStack"
      },
      "minItems": 0
    },
    "tags": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "uniqueItems": true
    },
    "loot": {
      "$ref": "#/$defs/Loot"
    },
    "gates": {
      "$ref": "#/$defs/Gates"
    },
    "client": {
      "$ref": "#/$defs/Client"
    },
    "text": {
      "$ref": "#/$defs/TextBlock"
    },
    "name_key": {
      "type": "string"
    },
    "lore_key": {
      "type": "string"
    },
    "tooltip_key": {
      "type": "string"
    },
    "effect_text_key": {
      "type": "string"
    },
    "brew_time_text_key": {
      "type": "string"
    },
    "ingredients_text_key": {
      "type": "string"
    },
    "container_text_key": {
      "type": "string"
    },
    "rarity_text_key": {
      "type": "string"
    },
    "category_text_key": {
      "type": "string"
    },
    "flavor_text_key": {
      "type": "string"
    },
    "warning_key": {
      "type": "string"
    },
    "crafting_instructions_key": {
      "type": "string"
    },
    "config": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "enabled": {
          "type": "boolean",
          "default": true
        },
        "disable_random_failures": {
          "type": "boolean",
          "default": false
        },
        "disable_spoilage": {
          "type": "boolean",
          "default": false
        },
        "abv_multiplier": {
          "type": "number",
          "minimum": 0,
          "default": 1.0
        },
        "effect_strength_multiplier": {
          "type": "number",
          "minimum": 0,
          "default": 1.0
        },
        "debug_logging": {
          "type": "boolean",
          "default": false
        }
      }
    },
    "events": {
      "type": "object",
      "description": "Optional data-driven hooks for scripting-like behavior.",
      "additionalProperties": false,
      "properties": {
        "on_drink": {
          "$ref": "common-schema.json#/$defs/EventList"
        },
        "on_open": {
          "$ref": "common-schema.json#/$defs/EventList"
        },
        "on_spoil": {
          "$ref": "common-schema.json#/$defs/EventList"
        }
      }
    }
  },
  "$defs": {
    "Meta": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "display_name": {
          "type": "string"
        },
        "icon": {
          "type": "string"
        },
        "sort_order": {
          "type": "integer"
        },
        "hidden": {
          "type": "boolean"
        },
        "notes": {
          "type": "string"
        },
        "source": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "pack": {
              "type": "string"
            },
            "author": {
              "type": "string"
            },
            "homepage": {
              "type": "string"
            }
          }
        }
      }
    },
    "Brewing": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "brew_time_seconds",
        "brew_time_ticks",
        "station_tags",
        "difficulty",
        "batch_size_servings",
        "byproducts",
        "failure"
      ],
      "properties": {
        "brew_time_seconds": {
          "type": "number",
          "minimum": 0
        },
        "brew_time_ticks": {
          "type": "integer",
          "minimum": 0
        },
        "station_tags": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "difficulty": {
          "type": "integer",
          "minimum": 0
        },
        "batch_size_servings": {
          "type": "integer",
          "minimum": 1
        },
        "byproducts": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/Byproduct"
          }
        },
        "failure": {
          "$ref": "#/$defs/Failure"
        }
      }
    },
    "Byproduct": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "item",
        "count",
        "chance"
      ],
      "properties": {
        "item": {
          "$ref": "common-schema.json#/$defs/Identifier"
        },
        "count": {
          "type": "integer",
          "minimum": 1
        },
        "chance": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        }
      }
    },
    "Failure": {
      "oneOf": [
        {
          "type": "object",
          "additionalProperties": false,
          "required": [
            "enabled"
          ],
          "properties": {
            "enabled": {
              "const": false
            }
          }
        },
        {
          "type": "object",
          "additionalProperties": false,
          "required": [
            "enabled",
            "base_fail_chance",
            "outcome"
          ],
          "properties": {
            "enabled": {
              "const": true
            },
            "base_fail_chance": {
              "type": "number",
              "minimum": 0,
              "maximum": 1
            },
            "outcome": {
              "$ref": "common-schema.json#/$defs/Identifier"
            },
            "extra_effects": {
              "type": "array",
              "items": {
                "$ref": "#/$defs/StatusEffect"
              },
              "default": []
            }
          }
        }
      ]
    },
    "Stats": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "alcohol_by_volume",
        "strength",
        "intoxication",
        "nutrition"
      ],
      "properties": {
        "alcohol_by_volume": {
          "type": "number",
          "minimum": 0,
          "maximum": 100
        },
        "strength": {
          "type": "number",
          "minimum": 0
        },
        "intoxication": {
          "type": "object",
          "additionalProperties": false,
          "required": [
            "value",
            "decay_rate_per_tick"
          ],
          "properties": {
            "value": {
              "type": "number",
              "minimum": 0
            },
            "decay_rate_per_tick": {
              "type": "number",
              "minimum": 0
            }
          }
        },
        "nutrition": {
          "type": "object",
          "additionalProperties": false,
          "required": [
            "hunger",
            "saturation"
          ],
          "properties": {
            "hunger": {
              "type": "integer",
              "minimum": 0
            },
            "saturation": {
              "type": "number",
              "minimum": 0
            }
          }
        }
      }
    },
    "Quality": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "tier",
        "supports_quality"
      ],
      "properties": {
        "tier": {
          "type": "string"
        },
        "supports_quality": {
          "type": "boolean"
        },
        "quality_on_brew": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "quality_floor": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "quality_ceiling": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        }
      }
    },
    "Aging": {
      "oneOf": [
        {
          "type": "object",
          "additionalProperties": false,
          "required": [
            "supported"
          ],
          "properties": {
            "supported": {
              "const": false
            }
          }
        },
        {
          "type": "object",
          "additionalProperties": false,
          "required": [
            "supported",
            "min_days",
            "max_days"
          ],
          "properties": {
            "supported": {
              "const": true
            },
            "min_days": {
              "type": "number",
              "minimum": 0
            },
            "max_days": {
              "type": "number",
              "minimum": 0
            },
            "preferred_container_tags": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "uniqueItems": true
            },
            "quality_bonus_per_day": {
              "type": "number",
              "minimum": 0
            },
            "risk_per_day_open": {
              "type": "number",
              "minimum": 0
            }
          }
        }
      ]
    },
    "Spoilage": {
      "oneOf": [
        {
          "type": "object",
          "additionalProperties": false,
          "required": [
            "enabled"
          ],
          "properties": {
            "enabled": {
              "const": false
            }
          }
        },
        {
          "type": "object",
          "additionalProperties": false,
          "required": [
            "enabled",
            "base_decay_per_day"
          ],
          "properties": {
            "enabled": {
              "const": true
            },
            "base_decay_per_day": {
              "type": "number",
              "minimum": 0
            },
            "opened_decay_multiplier": {
              "type": "number",
              "minimum": 0
            },
            "temperature": {
              "type": "object",
              "additionalProperties": false,
              "properties": {
                "preferred": {
                  "$ref": "common-schema.json#/$defs/TemperaturePreset"
                },
                "hot_decay_multiplier": {
                  "type": "number",
                  "minimum": 0
                },
                "cold_decay_multiplier": {
                  "type": "number",
                  "minimum": 0
                }
              }
            }
          }
        }
      ]
    },
    "Carbonation": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "level",
        "foam"
      ],
      "properties": {
        "level": {
          "enum": [
            "none",
            "low",
            "medium",
            "high"
          ]
        },
        "foam": {
          "type": "object",
          "additionalProperties": false,
          "required": [
            "enabled",
            "spill_chance_on_open"
          ],
          "properties": {
            "enabled": {
              "type": "boolean"
            },
            "spill_chance_on_open": {
              "type": "number",
              "minimum": 0,
              "maximum": 1
            }
          }
        }
      }
    },
    "Visuals": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "liquid_color",
        "bubbles",
        "glow",
        "particle"
      ],
      "properties": {
        "liquid_color": {
          "type": "integer",
          "minimum": 0,
          "maximum": 16777215
        },
        "bubbles": {
          "enum": [
            "none",
            "light",
            "medium",
            "heavy"
          ]
        },
        "glow": {
          "enum": [
            "none",
            "subtle",
            "strong"
          ]
        },
        "particle": {
          "type": "string"
        }
      }
    },
    "StatusEffect": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "effect",
        "duration",
        "amplifier",
        "chance"
      ],
      "properties": {
        "effect": {
          "$ref": "common-schema.json#/$defs/Identifier"
        },
        "duration": {
          "type": "integer",
          "minimum": 0
        },
        "amplifier": {
          "type": "integer",
          "minimum": 0
        },
        "chance": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "show_particles": {
          "type": "boolean"
        },
        "show_icon": {
          "type": "boolean"
        },
        "ambient": {
          "type": "boolean"
        }
      }
    },
    "IngredientStack": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "item",
        "count"
      ],
      "properties": {
        "item": {
          "$ref": "common-schema.json#/$defs/Identifier"
        },
        "count": {
          "type": "integer",
          "minimum": 1
        }
      }
    },
    "Loot": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "weight",
        "tables"
      ],
      "properties": {
        "weight": {
          "type": "integer",
          "minimum": 0
        },
        "tables": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "uniqueItems": true
        }
      }
    },
    "Gates": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "requires_feature_flag",
        "requires_gamerule_true"
      ],
      "properties": {
        "requires_feature_flag": {
          "type": "string"
        },
        "requires_gamerule_true": {
          "type": "string"
        },
        "min_player_level": {
          "type": "integer",
          "minimum": 0
        },
        "requires_mod_loaded": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "uniqueItems": true
        }
      }
    },
    "Client": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "use_liquid_tint",
        "show_strength_line",
        "show_quality_line",
        "show_spoilage_hint"
      ],
      "properties": {
        "use_liquid_tint": {
          "type": "boolean"
        },
        "show_strength_line": {
          "type": "boolean"
        },
        "show_quality_line": {
          "type": "boolean"
        },
        "show_spoilage_hint": {
          "type": "boolean"
        },
        "show_alcohol_by_volume": {
          "type": "boolean"
        },
        "tooltip_theme": {
          "enum": [
            "default",
            "detailed",
            "minimal"
          ]
        }
      }
    },
    "TextBlock": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "name_key": {
          "type": "string"
        },
        "lore_key": {
          "type": "string"
        },
        "tooltip_key": {
          "type": "string"
        },
        "effect_text_key": {
          "type": "string"
        },
        "brew_time_text_key": {
          "type": "string"
        },
        "ingredients_text_key": {
          "type": "string"
        },
        "container_text_key": {
          "type": "string"
        },
        "rarity_text_key": {
          "type": "string"
        },
        "category_text_key": {
          "type": "string"
        },
        "flavor_text_key": {
          "type": "string"
        },
        "warning_key": {
          "type": "string"
        },
        "crafting_instructions_key": {
          "type": "string"
        }
      }
    }
  },
  "patternProperties": {
    "^x-": {
      "type": [
        "object",
        "array",
        "string",
        "number",
        "integer",
        "boolean",
        "null"
      ]
    },
    "^_debug$": {
      "type": "object",
      "additionalProperties": true
    }
  }
}
